<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Soul Reactor v4.5 â€” Sound + Particles Fix</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
<style>
:root{--gold:#d4af37;--purple:#7c3aed;--bg0:#0b0613;--bg1:#120a21;}
html,body{height:100%;margin:0;background:#0b0613;color:#fff;font-family:Orbitron,sans-serif;}
body{display:flex;flex-direction:column;justify-content:space-between;min-height:100vh;overflow:hidden;background:linear-gradient(180deg,var(--bg1),var(--bg0));}
header{display:flex;justify-content:center;gap:10px;padding:8px;flex-wrap:wrap;}
.pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.25);}
.btn{background:linear-gradient(90deg,var(--gold),var(--purple));border:none;color:#fff;border-radius:12px;padding:8px 14px;cursor:pointer;font-weight:700;box-shadow:0 4px 14px rgba(0,0,0,.4);}
.btn.out{background:transparent;border:1px solid var(--gold);color:var(--gold);}
.xp-wrap{width:min(90vw,960px);margin:8px auto;}
.xp{height:24px;border-radius:999px;overflow:hidden;background:rgba(255,255,255,.1);}
.xp-fill{height:100%;width:0;background:linear-gradient(90deg,var(--gold),var(--purple));transition:width .3s;}
.arena{flex:1;display:grid;place-items:center;position:relative;overflow:hidden;}
.orb{width:min(40vh,300px);aspect-ratio:1;border-radius:50%;
background:radial-gradient(circle at 50% 45%,#fff6e0,#e1c25b 30%,rgba(124,58,237,.85) 65%,rgba(10,5,20,1) 85%);
box-shadow:0 0 60px rgba(124,58,237,.6),0 0 140px rgba(212,175,55,.45);
animation:throb 3s ease-in-out infinite;cursor:pointer;position:relative;z-index:5;}
@keyframes throb{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}
canvas#particles{position:absolute;inset:0;pointer-events:none;z-index:1;}
.controls{display:flex;justify-content:center;gap:12px;padding:12px;}
.modal-bg{position:fixed;inset:0;display:flex;align-items:flex-end;justify-content:center;background:rgba(0,0,0,.6);opacity:0;pointer-events:none;transition:.3s;}
.modal-bg.active{opacity:1;pointer-events:auto;}
.panel{width:100%;max-width:560px;border-radius:20px 20px 0 0;background:radial-gradient(900px 700px at 50% 0%,rgba(255,216,109,.65),rgba(106,0,255,.75));padding:18px;transform:translateY(100%);transition:.4s;}
.modal-bg.active .panel{transform:translateY(0);}
.row{display:flex;align-items:center;gap:12px;padding:10px;border-radius:12px;background:rgba(20,12,36,.45);}
.icon{width:72px;height:72px;border-radius:12px;overflow:hidden;background:#0f0a1d;display:grid;place-items:center;}
.icon img{width:100%;height:100%;object-fit:contain;}
.meta{flex:1}.name{font-weight:800}.sub{font-size:12px;opacity:.85}
#resetBtn{position:fixed;right:12px;bottom:calc(12px + env(safe-area-inset-bottom));padding:8px 12px;border-radius:10px;
background:linear-gradient(90deg,#ffd86d,#7c3aed);border:none;color:#fff;cursor:pointer;font-weight:700;z-index:30;}
footer{font-size:11px;opacity:.6;text-align:center;padding:4px;}
</style>
</head>
<body>
<header>
  <div class="pill">Souls: <span id="souls">0</span></div>
  <div class="pill">Stage: <span id="stage">Ember</span></div>
  <button id="soundBtn" class="btn out">ðŸ”‡ Sound Off</button>
</header>
<div class="xp-wrap"><div class="xp"><div id="xpFill" class="xp-fill"></div></div></div>
<div class="arena">
  <canvas id="particles"></canvas>
  <div id="orb" class="orb"></div>
</div>
<div class="controls">
  <button id="openStore" class="btn">ðŸ›’ Shop</button>
  <button id="openVault" class="btn">ðŸ§¬ Creatures</button>
  <button id="force" class="btn out">âš¡ Force Level-Up</button>
</div>

<!-- Modals -->
<div id="storeModal" class="modal-bg"><div class="panel"><h2>ðŸ›’ Reactor Upgrades</h2><button id="closeStore" class="btn out" style="width:100%;">Close</button></div></div>
<div id="vaultModal" class="modal-bg"><div class="panel"><h2>ðŸ§¬ Vault of Life</h2><button id="closeVault" class="btn out" style="width:100%;">Close</button></div></div>

<button id="resetBtn">â™» Reset</button>
<footer>v4.5 â€” Sound and Particles Restored</footer>

<script>
let souls=0, perTap=1, auto=0, soundOn=false, firstTap=false;
const soulsEl=document.getElementById("souls"), xpFill=document.getElementById("xpFill"), orb=document.getElementById("orb");
function update(){soulsEl.textContent=souls;xpFill.style.width=Math.min(souls,100)+"%";}
const tapSound=new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_03b3b0b6b4.mp3?filename=click-124467.mp3");
tapSound.volume=0.5;
const soundBtn=document.getElementById("soundBtn");
soundBtn.onclick=()=>{soundOn=!soundOn;soundBtn.textContent=soundOn?"ðŸ”Š Sound On":"ðŸ”‡ Sound Off";soundBtn.classList.toggle("out",!soundOn);};

function playClick(){
  if(!firstTap){firstTap=true;tapSound.play().then(()=>tapSound.pause());} // unlock
  if(soundOn){tapSound.currentTime=0;tapSound.play();}
}

// Particles
const canvas=document.getElementById("particles"),ctx=canvas.getContext("2d");
let particles=[];
function resize(){canvas.width=canvas.clientWidth;canvas.height=canvas.clientHeight;}
window.addEventListener("resize",resize);resize();
function spawn(x,y){for(let i=0;i<10;i++){particles.push({x,y,r:3+Math.random()*3,dx:(Math.random()-0.5)*4,dy:(Math.random()-0.5)*4,life:1});}}
function render(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 particles.forEach(p=>{
   p.x+=p.dx;p.y+=p.dy;p.life-=0.02;
   ctx.beginPath();ctx.fillStyle=`hsla(${260+Math.random()*40},100%,70%,${p.life})`;
   ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();
 });
 particles=particles.filter(p=>p.life>0);
 requestAnimationFrame(render);
}
render();

orb.addEventListener("click",e=>{
  const rect=canvas.getBoundingClientRect();
  spawn(e.clientX-rect.left,e.clientY-rect.top);
  playClick();
  souls+=perTap;update();
});
setInterval(()=>{if(auto>0){souls+=auto;update();}},1000);

document.getElementById("force").onclick=()=>{souls+=50;update();};

const storeModal=document.getElementById("storeModal"),vaultModal=document.getElementById("vaultModal");
document.getElementById("openStore").onclick=()=>{vaultModal.classList.remove("active");storeModal.classList.add("active");};
document.getElementById("openVault").onclick=()=>{storeModal.classList.remove("active");vaultModal.classList.add("active");};
document.getElementById("closeStore").onclick=()=>storeModal.classList.remove("active");
document.getElementById("closeVault").onclick=()=>vaultModal.classList.remove("active");

document.getElementById("resetBtn").onclick=()=>{souls=0;perTap=1;auto=0;update();};
update();
</script>
</body>
</html>
